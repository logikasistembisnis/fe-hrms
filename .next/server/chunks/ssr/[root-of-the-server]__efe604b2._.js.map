{"version":3,"sources":["turbopack:///[project]/src/app/(admin)/tenant/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useState, useEffect } from \"react\";\r\nimport { Tenant } from \"@/api/data\";\r\nimport { getTenant, saveTenant, deleteTenant } from \"@/api/tenantApi\";\r\n\r\nexport default function TenantPage() {\r\n    const [tenants, setTenants] = useState<Tenant[]>([]);\r\n    const [loading, setLoading] = useState(true);\r\n\r\n    // State untuk Modal & Form\r\n    const [isModalOpen, setIsModalOpen] = useState(false);\r\n    const [isSaving, setIsSaving] = useState(false);\r\n\r\n    // State Form Data\r\n    const [formData, setFormData] = useState<Partial<Tenant>>({\r\n        name: \"\",\r\n        description: \"\",\r\n        active: true,\r\n    });\r\n\r\n    // 1. Fetch Data saat halaman dimuat\r\n    const fetchData = async () => {\r\n        setLoading(true);\r\n        try {\r\n            const response = await getTenant();\r\n            // Pastikan response.data adalah array\r\n            if (Array.isArray(response.data)) {\r\n                setTenants(response.data);\r\n            } else {\r\n                setTenants([]);\r\n            }\r\n        } catch (error) {\r\n            console.error(\"Gagal mengambil data tenant:\", error);\r\n            alert(\"Gagal memuat data tenant.\");\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    useEffect(() => {\r\n        fetchData();\r\n    }, []);\r\n\r\n    // 2. Handle Delete\r\n    const handleDelete = async (id: number) => {\r\n        if (!confirm(\"Yakin ingin menghapus tenant ini?\")) return;\r\n\r\n        try {\r\n            await deleteTenant(id);\r\n            // Hapus dari state tanpa reload\r\n            setTenants((prev) => prev.filter((t) => t.tenantid !== id));\r\n            alert(\"Tenant berhasil dihapus.\");\r\n        } catch (error) {\r\n            console.error(error);\r\n            alert(\"Gagal menghapus tenant.\");\r\n        }\r\n    };\r\n\r\n    // 3. Handle Submit (Add / Edit)\r\n    const handleSubmit = async (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        setIsSaving(true);\r\n\r\n        try {\r\n            // Logic Upsert:\r\n            // Jika formData punya 'tenantid', backend akan Update.\r\n            // Jika tidak punya (undefined), backend akan Insert.\r\n\r\n            // Kirim dalam format Array []\r\n            await saveTenant([formData]);\r\n\r\n            alert(\"Data berhasil disimpan!\");\r\n            setIsModalOpen(false);\r\n            fetchData(); // Refresh tabel\r\n        } catch (error) {\r\n            console.error(error);\r\n            alert(\"Gagal menyimpan data.\");\r\n        } finally {\r\n            setIsSaving(false);\r\n        }\r\n    };\r\n\r\n    // Helper untuk membuka modal (Reset form jika tambah baru, isi form jika edit)\r\n    const openModal = (tenant?: Tenant) => {\r\n        if (tenant) {\r\n            // Mode Edit\r\n            setFormData(tenant);\r\n        } else {\r\n            // Mode Tambah Baru\r\n            setFormData({\r\n                name: \"\",\r\n                description: \"\",\r\n                active: true,\r\n                // holdingflag & holdingcompanyid bisa di-set default atau null\r\n                holdingflag: false,\r\n                holdingcompanyid: null\r\n            });\r\n        }\r\n        setIsModalOpen(true);\r\n    };\r\n\r\n    return (\r\n        <div className=\"p-6\">\r\n            <div className=\"flex justify-between items-center mb-6\">\r\n                <h1 className=\"text-2xl font-bold text-gray-800\">Daftar Tenant</h1>\r\n                <button\r\n                    onClick={() => openModal()}\r\n                    className=\"bg-[#0c356a] hover:bg-blue-900 text-white px-4 py-2 rounded-lg font-medium transition\"\r\n                >\r\n                    + Tambah Tenant\r\n                </button>\r\n            </div>\r\n\r\n            {/* --- TABEL --- */}\r\n            <div className=\"overflow-x-auto bg-white shadow-md rounded-lg\">\r\n                <table className=\"min-w-full text-left text-sm whitespace-nowrap\">\r\n                    <thead>\r\n                        <tr className=\"bg-blue-900 text-white text-center text-sm font-medium\">\r\n                            <th scope=\"col\" className=\"px-4 py-2\">Nama</th>\r\n                            <th scope=\"col\" className=\"px-4 py-2\">Deskripsi</th>\r\n                            <th scope=\"col\" className=\"px-4 py-2 text-center\">Status</th>\r\n                            <th scope=\"col\" className=\"px-4 py-2 text-center\">Aksi</th>\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                        {loading ? (\r\n                            <tr>\r\n                                <td colSpan={4} className=\"text-center py-6\">Loading...</td>\r\n                            </tr>\r\n                        ) : tenants.length === 0 ? (\r\n                            <tr>\r\n                                <td colSpan={4} className=\"text-center py-6 text-gray-500\">Tidak ada data tenant.</td>\r\n                            </tr>\r\n                        ) : (\r\n                            tenants.map((item) => (\r\n                                <tr key={item.tenantid} className=\"hover:bg-gray-50 transition text-center\">\r\n                                    <td className=\"px-6 py-4 font-medium text-gray-900\">{item.name}</td>\r\n                                    <td className=\"px-6 py-4 text-gray-500\">{item.description || \"-\"}</td>\r\n                                    <td className=\"px-6 py-4 text-center\">\r\n                                        <span\r\n                                            className={`px-2 py-1 rounded-full text-xs font-semibold ${item.active\r\n                                                    ? \"bg-green-100 text-green-800\"\r\n                                                    : \"bg-red-100 text-red-800\"\r\n                                                }`}\r\n                                        >\r\n                                            {item.active ? \"Active\" : \"Inactive\"}\r\n                                        </span>\r\n                                    </td>\r\n                                    <td className=\"px-6 py-4 text-center space-x-2\">\r\n                                        <button\r\n                                            onClick={() => openModal(item)}\r\n                                            className=\"bg-blue-600 px-3 py-1 text-white rounded-sm hover:bg-blue-900 font-medium\"\r\n                                        >\r\n                                            Edit\r\n                                        </button>\r\n                                        <button\r\n                                            onClick={() => handleDelete(item.tenantid)}\r\n                                            className=\"bg-red-600 text-white px-3 py-1 rounded-sm hover:bg-red-900 font-medium\"\r\n                                        >\r\n                                            Hapus\r\n                                        </button>\r\n                                    </td>\r\n                                </tr>\r\n                            ))\r\n                        )}\r\n                    </tbody>\r\n                </table>\r\n            </div>\r\n\r\n            {/* --- MODAL FORM --- */}\r\n            {isModalOpen && (\r\n                <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/10 bg-opacity-50 backdrop-blur-sm p-4\">\r\n                    <div className=\"bg-white rounded-xl shadow-2xl w-full max-w-md p-6\">\r\n                        <h2 className=\"text-xl font-bold mb-4 text-gray-800\">\r\n                            {formData.tenantid ? \"Edit Tenant\" : \"Tambah Tenant Baru\"}\r\n                        </h2>\r\n\r\n                        <form onSubmit={handleSubmit} className=\"space-y-4\">\r\n                            {/* Nama */}\r\n                            <div>\r\n                                <label className=\"block text-sm font-medium text-gray-700 mb-1\">Nama Tenant</label>\r\n                                <input\r\n                                    type=\"text\"\r\n                                    required\r\n                                    value={formData.name || \"\"}\r\n                                    onChange={(e) => setFormData({ ...formData, name: e.target.value })}\r\n                                    className=\"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 outline-none\"\r\n                                    placeholder=\"Contoh: ABC Group\"\r\n                                />\r\n                            </div>\r\n\r\n                            {/* Description */}\r\n                            <div>\r\n                                <label className=\"block text-sm font-medium text-gray-700 mb-1\">Deskripsi</label>\r\n                                <textarea\r\n                                    value={formData.description || \"\"}\r\n                                    onChange={(e) => setFormData({ ...formData, description: e.target.value })}\r\n                                    className=\"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 outline-none\"\r\n                                    placeholder=\"Keterangan singkat...\"\r\n                                    rows={3}\r\n                                />\r\n                            </div>\r\n\r\n                            {/* Active Toggle */}\r\n                            <div className=\"flex items-center gap-2\">\r\n                                <input\r\n                                    type=\"checkbox\"\r\n                                    id=\"activeCheck\"\r\n                                    checked={formData.active ?? true}\r\n                                    onChange={(e) => setFormData({ ...formData, active: e.target.checked })}\r\n                                    className=\"w-5 h-5 text-blue-600 rounded focus:ring-blue-500 border-gray-300\"\r\n                                />\r\n                                <label htmlFor=\"activeCheck\" className=\"text-sm font-medium text-gray-700\">\r\n                                    Aktif\r\n                                </label>\r\n                            </div>\r\n\r\n                            {/* Action Buttons */}\r\n                            <div className=\"flex justify-end gap-3 mt-6\">\r\n                                <button\r\n                                    type=\"button\"\r\n                                    onClick={() => setIsModalOpen(false)}\r\n                                    className=\"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition\"\r\n                                >\r\n                                    Batal\r\n                                </button>\r\n                                <button\r\n                                    type=\"submit\"\r\n                                    disabled={isSaving}\r\n                                    className={`px-4 py-2 text-white rounded-lg transition font-medium ${isSaving ? \"bg-blue-400 cursor-not-allowed\" : \"bg-[#0c356a] hover:bg-blue-900\"\r\n                                        }`}\r\n                                >\r\n                                    {isSaving ? \"Menyimpan...\" : \"Simpan\"}\r\n                                </button>\r\n                            </div>\r\n                        </form>\r\n                    </div>\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}"],"names":[],"mappings":"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"}